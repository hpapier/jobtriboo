{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport { FormControl, Input, InputLabel, TextField, Button, Select, MenuItem } from '@material-ui/core';\nimport Modal from 'react-modal';\nimport { withTranslation } from './i18n';\nimport { withRouter } from 'next/router';\nimport { useCookies } from 'react-cookie';\nimport { request } from '../utils/request';\nimport LoginTab from '../store/container/login';\nModal.setAppElement(\"#__next\");\n\nvar ModalConnexion = function ModalConnexion(_ref) {\n  var t = _ref.t,\n      modalOpen = _ref.modalOpen,\n      modalWindowLogin = _ref.modalWindowLogin,\n      setModalOpenState = _ref.setModalOpenState,\n      setMWindowLogin = _ref.setMWindowLogin,\n      router = _ref.router,\n      storeUserInfo = _ref.storeUserInfo,\n      setLoginState = _ref.setLoginState;\n\n  /* State */\n  var _useState = useState(1),\n      birthDateDay = _useState[0],\n      setBirthDateDay = _useState[1];\n\n  var _useState2 = useState(1),\n      birthDateMonth = _useState2[0],\n      setBirthDateMonth = _useState2[1];\n\n  var _useState3 = useState(2019),\n      birthDateYear = _useState3[0],\n      setBirthDateYear = _useState3[1];\n\n  var _useState4 = useState(\"candidate\"),\n      status = _useState4[0],\n      setStatus = _useState4[1];\n\n  var _useState5 = useState(true),\n      validationBtnState = _useState5[0],\n      setValidationBtnState = _useState5[1];\n\n  var _useState6 = useState(''),\n      firstName = _useState6[0],\n      setFirstName = _useState6[1];\n\n  var _useState7 = useState(''),\n      lastName = _useState7[0],\n      setLastName = _useState7[1];\n\n  var _useState8 = useState(''),\n      email = _useState8[0],\n      setEmail = _useState8[1];\n\n  var _useState9 = useState(''),\n      password = _useState9[0],\n      setPassword = _useState9[1];\n\n  var _useState10 = useState(false),\n      fieldError = _useState10[0],\n      setFieldError = _useState10[1];\n\n  var _useState11 = useState(0),\n      validationStatus = _useState11[0],\n      setValidationStatus = _useState11[1];\n\n  var _useCookies = useCookies(),\n      _useCookies2 = _slicedToArray(_useCookies, 3),\n      cookies = _useCookies2[0],\n      setCookies = _useCookies2[1],\n      removeCookies = _useCookies2[2];\n\n  console.log('COOKIES: ', cookies);\n  /* Utils function */\n\n  var getDayList = function getDayList() {\n    var dayNumber = 31;\n    if (birthDateMonth % 2 === 0 && birthDateMonth != 8) dayNumber = 30;\n\n    if (birthDateMonth === 2) {\n      if (birthDateYear % 4 === 0) {\n        if (birthDateYear % 100 === 0) {\n          if (birthDateYear % 400 === 0) dayNumber = 29;else dayNumber = 28;\n        } else dayNumber = 29;\n      }\n\n      dayNumber = 28;\n    }\n\n    if (dayNumber < birthDateDay) setBirthDateDay(dayNumber);\n    var dateElements = [];\n\n    for (var i = 1; i <= dayNumber; i++) {\n      dateElements.push(__jsx(MenuItem, {\n        key: i,\n        value: i\n      }, i));\n    }\n\n    return dateElements;\n  };\n\n  var getMonthList = function getMonthList() {\n    var monthElement = [];\n\n    for (var i = 1; i <= 12; i++) {\n      monthElement.push(__jsx(MenuItem, {\n        key: i,\n        value: i\n      }, i));\n    }\n\n    return monthElement;\n  };\n\n  var getYearList = function getYearList() {\n    var yearElement = [];\n\n    for (var i = new Date().getFullYear(); i >= 1900; i--) {\n      yearElement.push(__jsx(MenuItem, {\n        key: i,\n        value: i\n      }, i));\n    }\n\n    return yearElement;\n  };\n\n  var handleValidation =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(event) {\n      var birthDate, res, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              setValidationBtnState(false);\n\n              if (!(firstName === '' || lastName === '' || email === '' || password === '')) {\n                _context.next = 8;\n                break;\n              }\n\n              setFieldError(true);\n              setValidationBtnState(true);\n              return _context.abrupt(\"return\");\n\n            case 8:\n              _context.prev = 8;\n              birthDate = new Date(birthDateYear + \"-\" + birthDateMonth + \"-\" + birthDateDay); // .. Start loading front-end process\n\n              _context.next = 12;\n              return request(\"/api/register\", {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: {\n                  status: status,\n                  firstName: firstName,\n                  lastName: lastName,\n                  email: email,\n                  password: password,\n                  birthDate: birthDate\n                }\n              });\n\n            case 12:\n              res = _context.sent;\n\n              if (!(res.status === 201)) {\n                _context.next = 26;\n                break;\n              }\n\n              _context.next = 16;\n              return res.json();\n\n            case 16:\n              data = _context.sent;\n              setCookies('token', data.token);\n              storeUserInfo({\n                firstName: firstName,\n                lastName: lastName,\n                email: email,\n                password: password,\n                birthDate: birthDate\n              });\n              setValidationStatus(201);\n              setValidationBtnState(true);\n              setModalOpenState(false);\n              setLoginState(true);\n              router.push('/settings');\n              _context.next = 29;\n              break;\n\n            case 26:\n              setValidationStatus(res.status);\n              setEmail('');\n              setValidationBtnState(true);\n\n            case 29:\n              _context.next = 36;\n              break;\n\n            case 31:\n              _context.prev = 31;\n              _context.t0 = _context[\"catch\"](8);\n              console.log(_context.t0);\n              setValidationBtnState(true);\n              setValidationStatus(500);\n\n            case 36:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[8, 31]]);\n    }));\n\n    return function handleValidation(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  /* Jsx Rendering */\n\n\n  return __jsx(Modal, {\n    isOpen: modalOpen,\n    onRequestClose: function onRequestClose() {\n      return setModalOpenState(false);\n    },\n    style: {\n      overlay: {\n        backgroundColor: \"rgba(0, 0, 0, 0.6)\"\n      },\n      content: {\n        opacity: \"1\",\n        width: '700px',\n        margin: 'auto'\n      }\n    }\n  }, __jsx(Button, {\n    variant: !modalWindowLogin ? \"outlined\" : \"contained\",\n    onClick: function onClick() {\n      return setMWindowLogin(true);\n    },\n    style: {\n      margin: 5\n    },\n    color: \"primary\"\n  }, t('login')), __jsx(Button, {\n    variant: !modalWindowLogin ? \"contained\" : \"outlined\",\n    onClick: function onClick() {\n      return setMWindowLogin(false);\n    },\n    style: {\n      margin: 5\n    },\n    color: \"primary\"\n  }, t('register')), __jsx(\"hr\", null), modalWindowLogin ? __jsx(LoginTab, null) : __jsx(\"form\", {\n    onSubmit: handleValidation\n  }, __jsx(\"div\", null, __jsx(Button, {\n    variant: status !== \"candidate\" ? \"outlined\" : \"contained\",\n    color: \"secondary\",\n    onClick: function onClick() {\n      return setStatus(\"candidate\");\n    },\n    style: {\n      margin: 5\n    }\n  }, t('candidate')), __jsx(Button, {\n    variant: status !== \"recruiter\" ? \"outlined\" : \"contained\",\n    color: \"secondary\",\n    onClick: function onClick() {\n      return setStatus(\"recruiter\");\n    },\n    style: {\n      margin: 5\n    }\n  }, t('recruiter'))), __jsx(\"div\", null, __jsx(TextField, {\n    label: t('firstName'),\n    type: \"text\",\n    name: \"firstName\",\n    variant: \"filled\",\n    style: {\n      margin: 5\n    },\n    value: firstName,\n    onChange: function onChange(e) {\n      return setFirstName(e.target.value);\n    },\n    error: fieldError && firstName === ''\n  }), __jsx(TextField, {\n    label: t('lastName'),\n    type: \"text\",\n    name: \"lastName\",\n    variant: \"filled\",\n    style: {\n      margin: 5\n    },\n    value: lastName,\n    onChange: function onChange(e) {\n      return setLastName(e.target.value);\n    },\n    error: fieldError && lastName === ''\n  })), __jsx(\"div\", null, __jsx(TextField, {\n    label: t('email'),\n    type: \"email\",\n    name: \"email\",\n    variant: \"filled\",\n    autoComplete: \"email\",\n    style: {\n      margin: 5\n    },\n    value: email,\n    onChange: function onChange(e) {\n      return setEmail(e.target.value);\n    },\n    error: fieldError && email === ''\n  }), __jsx(TextField, {\n    label: t('password'),\n    type: \"password\",\n    name: \"password\",\n    variant: \"filled\",\n    value: password,\n    autoComplete: \"new-password\",\n    style: {\n      margin: 5\n    },\n    onChange: function onChange(e) {\n      return setPassword(e.target.value);\n    },\n    error: fieldError && password === ''\n  })), __jsx(\"div\", {\n    style: {\n      margin: \"5px 0px\"\n    }\n  }, __jsx(FormControl, null, __jsx(InputLabel, {\n    htmlFor: \"age-customized-select\",\n    style: {\n      margin: \"0px 5px\"\n    }\n  }, t('birthDateDay')), __jsx(Select, {\n    value: birthDateDay,\n    onChange: function onChange(e) {\n      return setBirthDateDay(e.target.value);\n    },\n    style: {\n      margin: \"10px 5px\",\n      width: \"60px\"\n    }\n  }, getDayList())), __jsx(FormControl, null, __jsx(InputLabel, {\n    htmlFor: \"age-customized-select\",\n    style: {\n      margin: \"0px 5px\"\n    }\n  }, t('birthDateMonth')), __jsx(Select, {\n    value: birthDateMonth,\n    onChange: function onChange(e) {\n      return setBirthDateMonth(e.target.value);\n    },\n    style: {\n      margin: \"10px 5px\",\n      width: \"60px\"\n    }\n  }, getMonthList())), __jsx(FormControl, null, __jsx(InputLabel, {\n    htmlFor: \"age-customized-select\",\n    style: {\n      margin: \"0px 5px\"\n    }\n  }, t('birthDateYear')), __jsx(Select, {\n    value: birthDateYear,\n    onChange: function onChange(e) {\n      return setBirthDateYear(e.target.value);\n    },\n    style: {\n      margin: \"10px 5px\",\n      width: \"100px\"\n    }\n  }, getYearList()))), __jsx(\"div\", null, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    style: {\n      margin: 5\n    },\n    type: \"submit\",\n    disabled: !validationBtnState\n  }, t('validate'))), validationStatus !== 0 ? __jsx(\"div\", null, __jsx(\"p\", null, validationStatus === 201 ? 'success' : validationStatus === 200 ? 'Email already used' : 'an error occured')) : null));\n};\n\nexport default withTranslation('common')(withRouter(ModalConnexion));","map":{"version":3,"sources":["/Users/hugopapier/Documents/jobTriboo/app/components/modalConnexion.js"],"names":["React","useState","FormControl","Input","InputLabel","TextField","Button","Select","MenuItem","Modal","withTranslation","withRouter","useCookies","request","LoginTab","setAppElement","ModalConnexion","t","modalOpen","modalWindowLogin","setModalOpenState","setMWindowLogin","router","storeUserInfo","setLoginState","birthDateDay","setBirthDateDay","birthDateMonth","setBirthDateMonth","birthDateYear","setBirthDateYear","status","setStatus","validationBtnState","setValidationBtnState","firstName","setFirstName","lastName","setLastName","email","setEmail","password","setPassword","fieldError","setFieldError","validationStatus","setValidationStatus","cookies","setCookies","removeCookies","console","log","getDayList","dayNumber","dateElements","i","push","getMonthList","monthElement","getYearList","yearElement","Date","getFullYear","handleValidation","event","preventDefault","birthDate","method","headers","body","res","json","data","token","overlay","backgroundColor","content","opacity","width","margin","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState }  from 'react';\nimport { FormControl, Input, InputLabel, TextField, Button, Select, MenuItem } from '@material-ui/core'\nimport Modal from 'react-modal'\nimport { withTranslation } from './i18n'\nimport { withRouter } from 'next/router'\nimport { useCookies } from 'react-cookie'\n\nimport { request } from '../utils/request'\nimport LoginTab from '../store/container/login'\n\nModal.setAppElement(\"#__next\");\n\nconst ModalConnexion = ({ t, modalOpen, modalWindowLogin, setModalOpenState, setMWindowLogin, router, storeUserInfo, setLoginState }) => {\n  /* State */\n  const [birthDateDay, setBirthDateDay] = useState(1);\n  const [birthDateMonth, setBirthDateMonth] = useState(1);\n  const [birthDateYear, setBirthDateYear] = useState(2019);\n  const [status, setStatus] = useState(\"candidate\");\n  const [validationBtnState, setValidationBtnState] = useState(true);\n\n  const [firstName, setFirstName] = useState('');\n  const [lastName, setLastName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n\n  const [fieldError, setFieldError] = useState(false);\n  const [validationStatus, setValidationStatus] = useState(0);\n\n  const [cookies, setCookies, removeCookies] = useCookies();\n  console.log('COOKIES: ', cookies);\n\n  /* Utils function */\n  const getDayList = () => {\n    let dayNumber = 31;\n\n    if (birthDateMonth % 2 === 0 && birthDateMonth != 8)\n      dayNumber = 30;\n    if (birthDateMonth === 2) {\n      if (birthDateYear % 4 === 0) {\n        if (birthDateYear % 100 === 0) {\n          if (birthDateYear % 400 === 0)\n            dayNumber = 29;\n          else\n            dayNumber = 28;\n        }\n        else\n        dayNumber = 29;\n      }\n      dayNumber = 28;\n    }\n\n    if (dayNumber < birthDateDay)\n      setBirthDateDay(dayNumber);\n    \n    let dateElements = [];\n    for(let i = 1; i <= dayNumber; i++)\n      dateElements.push(<MenuItem key={i} value={i}>{i}</MenuItem>);\n    \n    return dateElements;\n  }\n\n  const getMonthList = () => {\n    let monthElement = [];\n\n    for (let i = 1; i <= 12; i++)\n      monthElement.push(<MenuItem key={i} value={i}>{i}</MenuItem>);\n\n    return monthElement;\n  }\n\n  const getYearList = () => {\n    let yearElement = [];\n\n    for (let i = new Date().getFullYear(); i >= 1900; i--)\n      yearElement.push(<MenuItem key={i} value={i}>{i}</MenuItem>);\n\n    return yearElement;\n  }\n\n  const handleValidation = async event => {\n    event.preventDefault();\n    setValidationBtnState(false);\n    \n    if (firstName === '' || lastName === '' || email === '' || password === '') {\n      setFieldError(true);\n      setValidationBtnState(true);\n      return;\n    }\n    else {\n      try {\n  \n        const birthDate = new Date(birthDateYear + \"-\" + birthDateMonth + \"-\" + birthDateDay);\n        \n        // .. Start loading front-end process\n        const res = await request(\n          \"/api/register\",\n          {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: {\n              status,\n              firstName,\n              lastName,\n              email,\n              password,\n              birthDate\n            }\n          }\n        );\n        // .. End loading front-end process\n\n        \n        \n        if (res.status === 201) {\n          const data = await res.json();\n\n          setCookies('token', data.token);\n          storeUserInfo({ firstName, lastName, email, password, birthDate });\n\n          setValidationStatus(201);\n          setValidationBtnState(true);\n          setModalOpenState(false);\n\n          setLoginState(true);\n          router.push('/settings');\n        }\n        else {\n          setValidationStatus(res.status);\n          setEmail('');\n          setValidationBtnState(true);\n        }\n      } catch (e) {\n        console.log(e);\n        setValidationBtnState(true);\n        setValidationStatus(500);\n      }\n    }\n  }\n\n  /* Jsx Rendering */\n  return (\n    <Modal\n      isOpen={modalOpen}\n      onRequestClose={() => setModalOpenState(false)}\n      style={{ overlay: { backgroundColor: \"rgba(0, 0, 0, 0.6)\"}, content: { opacity: \"1\", width: '700px', margin: 'auto' } }}\n    >\n      <Button variant={!modalWindowLogin ? \"outlined\" : \"contained\"} onClick={() => setMWindowLogin(true)} style={{ margin: 5 }} color='primary'>{t('login')}</Button>\n      <Button variant={!modalWindowLogin ? \"contained\" : \"outlined\"} onClick={() => setMWindowLogin(false)} style={{ margin: 5 }} color='primary'>{t('register')}</Button>\n      <hr />\n\n      {\n        modalWindowLogin ?\n        <LoginTab /> :\n        (\n          <form onSubmit={handleValidation}>\n\n            <div>\n              <Button\n                variant={(status !== \"candidate\") ? \"outlined\" : \"contained\"}\n                color=\"secondary\"\n                onClick={() => setStatus(\"candidate\")}\n                style={{ margin: 5}}\n              >\n                {t('candidate')}\n              </Button>\n              <Button\n                variant={(status !== \"recruiter\") ? \"outlined\" : \"contained\"}\n                color=\"secondary\"\n                onClick={() => setStatus(\"recruiter\")}\n                style={{ margin: 5}}\n              >\n                {t('recruiter')}\n              </Button>\n            </div>\n\n            <div>\n              <TextField\n                label={t('firstName')}\n                type=\"text\"\n                name=\"firstName\"\n                variant=\"filled\"\n                style={{ margin: 5}}\n                value={firstName}\n                onChange={e => setFirstName(e.target.value)}\n                error={fieldError && firstName === ''}\n              />\n\n              <TextField\n                label={t('lastName')}\n                type=\"text\"\n                name=\"lastName\"\n                variant=\"filled\"\n                style={{ margin: 5}}\n                value={lastName}\n                onChange={e => setLastName(e.target.value)}\n                error={fieldError && lastName === ''}\n              />\n            </div>\n\n            <div>\n              <TextField\n                label={t('email')}\n                type=\"email\"\n                name=\"email\"\n                variant=\"filled\"\n                autoComplete=\"email\"\n                style={{ margin: 5}}\n                value={email}\n                onChange={e => setEmail(e.target.value)}\n                error={fieldError && email === ''}\n              />\n\n              <TextField\n                label={t('password')}\n                type=\"password\"\n                name=\"password\"\n                variant=\"filled\"\n                value={password}\n                autoComplete=\"new-password\"\n                style={{ margin: 5}}\n                onChange={e => setPassword(e.target.value)}\n                error={fieldError && password === ''}\n              />\n            </div>\n\n            <div style={{ margin: \"5px 0px\"}}> \n              <FormControl>\n                <InputLabel htmlFor=\"age-customized-select\" style={{ margin: \"0px 5px\"}}>{t('birthDateDay')}</InputLabel>\n                <Select\n                  value={birthDateDay}\n                  onChange={e => setBirthDateDay(e.target.value)}\n                  style={{ margin: \"10px 5px\", width: \"60px\"}}\n                >\n                  {getDayList()}\n                </Select>\n              </FormControl>\n\n              <FormControl>\n                <InputLabel htmlFor=\"age-customized-select\" style={{ margin: \"0px 5px\"}}>{t('birthDateMonth')}</InputLabel>\n                <Select\n                  value={birthDateMonth}\n                  onChange={e => setBirthDateMonth(e.target.value)}\n                  style={{ margin: \"10px 5px\", width: \"60px\"}}\n                >\n                  {getMonthList()}\n                </Select>\n              </FormControl>\n\n              <FormControl>\n                <InputLabel htmlFor=\"age-customized-select\" style={{ margin: \"0px 5px\"}}>{t('birthDateYear')}</InputLabel>\n                <Select\n                  value={birthDateYear}\n                  onChange={e => setBirthDateYear(e.target.value)}\n                  style={{ margin: \"10px 5px\", width: \"100px\"}}\n                >\n                  {getYearList()}\n                </Select>\n              </FormControl>\n\n            </div>\n\n            <div>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                style={{ margin: 5}}\n                type='submit'\n                disabled={!validationBtnState}\n              >\n                {t('validate')}\n              </Button>\n            </div>\n\n            {\n              validationStatus !== 0 ?\n              (<div>\n                { <p>{validationStatus === 201 ? 'success' : validationStatus === 200 ? 'Email already used' : 'an error occured'}</p> }\n              </div>) :\n              null\n            }\n\n          </form>\n        )\n      }\n\n    </Modal>\n  )\n}\n\nexport default withTranslation('common')(withRouter(ModalConnexion));"]},"metadata":{},"sourceType":"module"}